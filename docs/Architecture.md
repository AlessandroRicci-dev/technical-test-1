# Project structure

## Folders

The project follows Laravel's standard conventions. Below are the most relevant directories:

```code

 â”£ ðŸ“‚ app
 â”ƒ â”£ Http
 â”ƒ â”ƒ â”£ ðŸ“‚ Models -> contains all the models
 â”ƒ â”ƒ â”£ ðŸ“‚ Controllers -> contain all the controllers
 â”ƒ â”ƒ â”£ ðŸ“‚ Request -> contain all the Validation class requests
 â”ƒ â”ƒ â”£ ðŸ“‚ Services -> contain Api services
 â”£ ðŸ“‚ database -> contain database migrations, seeders and data factory
 â”£ ðŸ“‚ routes -> contains all the routes configured
 â”£ ðŸ“‚ config -> a list of configs
 â”£ ðŸ“‚ tests  -> Unit and feature testing
```

## Code architecture

The project uses a service-based architecture to manage orders. The main logic is contained in a dedicated controller:

app/Http/Controllers/Api/V1/OrderController.php

### OrderController

This controller is responsible for handling all order-related API requests. It imports and utilizes a dedicated service:

```code
private $orderService;

public function __construct(OrderService $orderService)
{
    $this->orderService = $orderService;
}
```

Each method in the controller is mapped in routes/api.php and receives a specific request class (e.g., OrderIndexRequest).

Validates:

-   Permissions of the requesting user.

-   Data integrity.

### Order Service

The OrderService manages all order-related business logic, ensuring clean separation from controllers.

Responsibilities:

-   Listing, creating, updating, and deleting orders.

-   Managing stock adjustments.

-   Enforcing business rules and validations.

Future Improvements:

Refactor into specialized services:

-   OrderProcessorService -> Handles order creation and updates.

-   StockManagementService -> Manages stock changes.

## Database

The application uses a MariaDB database, and some tables are automatically generated by Laravel and its dependencies. Below, we describe only the tables created for order management

### Tables

```code

â”£ users -> Store application user with roles
â”£ orders -> Store orders
â”£ products -> Store products and stocks levels
â”£ order_items -> Store related products of an order

```

### Relationships Between Tables

In each model (App/Models) you will find relationship between tables:

A user can have multiple orders â†’ A User has many Orders (User hasMany Orders).

```code

 public function orders()
    {
        return $this->hasMany(Order::class);
    }

```

An order belongs to a single user â†’ An Order belongs to a User.

```code

 public function user()
    {
        return $this->belongsTo(User::class);
    }

```

An order can contain multiple products â†’ An Order has many Products through OrderItems.

```code

    public function products()
    {
        return $this->hasManyThrough(
            Product::class,
            OrderItem::class,
            'order_id',
            'id',
            'id',
            'product_id'
        );
    }

```
